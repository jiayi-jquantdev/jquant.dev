/home/codespace/.python/current/lib/python3.12/site-packages/pandas/core/nanops.py:1020: RuntimeWarning: invalid value encountered in subtract
  sqr = _ensure_numeric((avg - values) ** 2)
/home/codespace/.python/current/lib/python3.12/site-packages/numpy/_core/_methods.py:49: RuntimeWarning: invalid value encountered in reduce
  return umr_sum(a, axis, dtype, out, keepdims, initial, where)
Features selected by variance: 150 Stable features (80% coverage 2019-2025): 36
Selected features: 36 folds: 4
Imputation medians sample: {2014: {'pe_mean_by_stock': nan, 'totalAssets': nan, 'totalLiabilities': nan, 'totalRevenue': nan, 'operatingCashflow': nan, 'netIncome': nan, 'overview_GrossProfitTTM': nan, 'overview_SharesFloat': nan, 'overview_SharesOutstanding': nan, 'lag_ma_10m': nan, 'lag_price_+6m': nan, 'lag_overview_52WeekHigh': nan, 'overview_52WeekHigh': nan, 'overview_200DayMovingAverage': nan, 'overview_50DayMovingAverage': nan, 'lag_overview_52WeekLow': nan, 'overview_52WeekLow': nan, 'overview_DilutedEPSTTM': nan, 'overview_PercentInstitutions': nan, 'overview_QuarterlyEarningsGrowthYOY': nan, 'overview_PercentInsiders': nan, 'overview_QuarterlyRevenueGrowthYOY': nan, 'lag_forward_6m_return': nan, 'overview_Beta': nan, 'lag_price_vs_ma10': nan, 'pe_trailing': nan, 'r1m_x_pe_trailing': nan, 'r1m_x_pe_mean_by_stock': nan, 'r3m_x_pe_trailing': nan, 'r3m_x_pe_mean_by_stock': nan, 'r6m_x_pe_trailing': nan, 'r6m_x_pe_mean_by_stock': nan, 'r12m_x_pe_trailing': nan, 'r12m_x_pe_mean_by_stock': nan, 'overview_MarketCapitalization': nan, 'overview_RevenueTTM': nan}, 2015: {'pe_mean_by_stock': nan, 'totalAssets': nan, 'totalLiabilities': nan, 'totalRevenue': nan, 'operatingCashflow': nan, 'netIncome': nan, 'overview_GrossProfitTTM': nan, 'overview_SharesFloat': nan, 'overview_SharesOutstanding': nan, 'lag_ma_10m': 32.278774999999996, 'lag_price_+6m': 37.17665, 'lag_overview_52WeekHigh': nan, 'overview_52WeekHigh': nan, 'overview_200DayMovingAverage': nan, 'overview_50DayMovingAverage': nan, 'lag_overview_52WeekLow': nan, 'overview_52WeekLow': nan, 'overview_DilutedEPSTTM': nan, 'overview_PercentInstitutions': nan, 'overview_QuarterlyEarningsGrowthYOY': nan, 'overview_PercentInsiders': nan, 'overview_QuarterlyRevenueGrowthYOY': nan, 'lag_forward_6m_return': 0.1678731559324434, 'overview_Beta': nan, 'lag_price_vs_ma10': 0.9850351462211719, 'pe_trailing': nan, 'r1m_x_pe_trailing': 0.0, 'r1m_x_pe_mean_by_stock': 0.0, 'r3m_x_pe_trailing': 0.0, 'r3m_x_pe_mean_by_stock': 0.0, 'r6m_x_pe_trailing': 0.0, 'r6m_x_pe_mean_by_stock': 0.0, 'r12m_x_pe_trailing': 0.0, 'r12m_x_pe_mean_by_stock': 0.0, 'overview_MarketCapitalization': nan, 'overview_RevenueTTM': nan}, 2016: {'pe_mean_by_stock': nan, 'totalAssets': nan, 'totalLiabilities': nan, 'totalRevenue': nan, 'operatingCashflow': nan, 'netIncome': nan, 'overview_GrossProfitTTM': nan, 'overview_SharesFloat': nan, 'overview_SharesOutstanding': nan, 'lag_ma_10m': 32.933214285714286, 'lag_price_+6m': 33.40185, 'lag_overview_52WeekHigh': nan, 'overview_52WeekHigh': nan, 'overview_200DayMovingAverage': nan, 'overview_50DayMovingAverage': nan, 'lag_overview_52WeekLow': nan, 'overview_52WeekLow': nan, 'overview_DilutedEPSTTM': nan, 'overview_PercentInstitutions': nan, 'overview_QuarterlyEarningsGrowthYOY': nan, 'overview_PercentInsiders': nan, 'overview_QuarterlyRevenueGrowthYOY': nan, 'lag_forward_6m_return': 0.03438556117623045, 'overview_Beta': nan, 'lag_price_vs_ma10': 0.9850351462211719, 'pe_trailing': nan, 'r1m_x_pe_trailing': 0.0, 'r1m_x_pe_mean_by_stock': 0.0, 'r3m_x_pe_trailing': 0.0, 'r3m_x_pe_mean_by_stock': 0.0, 'r6m_x_pe_trailing': 0.0, 'r6m_x_pe_mean_by_stock': 0.0, 'r12m_x_pe_trailing': 0.0, 'r12m_x_pe_mean_by_stock': 0.0, 'overview_MarketCapitalization': nan, 'overview_RevenueTTM': nan}, 2017: {'pe_mean_by_stock': nan, 'totalAssets': nan, 'totalLiabilities': nan, 'totalRevenue': nan, 'operatingCashflow': nan, 'netIncome': nan, 'overview_GrossProfitTTM': nan, 'overview_SharesFloat': nan, 'overview_SharesOutstanding': nan, 'lag_ma_10m': 33.25342928571429, 'lag_price_+6m': 36.0369, 'lag_overview_52WeekHigh': nan, 'overview_52WeekHigh': nan, 'overview_200DayMovingAverage': nan, 'overview_50DayMovingAverage': nan, 'lag_overview_52WeekLow': nan, 'overview_52WeekLow': nan, 'overview_DilutedEPSTTM': nan, 'overview_PercentInstitutions': nan, 'overview_QuarterlyEarningsGrowthYOY': nan, 'overview_PercentInsiders': nan, 'overview_QuarterlyRevenueGrowthYOY': nan, 'lag_forward_6m_return': 0.06620560494867785, 'overview_Beta': nan, 'lag_price_vs_ma10': 1.017886192067989, 'pe_trailing': nan, 'r1m_x_pe_trailing': 0.0, 'r1m_x_pe_mean_by_stock': 0.0, 'r3m_x_pe_trailing': 0.0, 'r3m_x_pe_mean_by_stock': 0.0, 'r6m_x_pe_trailing': 0.0, 'r6m_x_pe_mean_by_stock': 0.0, 'r12m_x_pe_trailing': 0.0, 'r12m_x_pe_mean_by_stock': 0.0, 'overview_MarketCapitalization': nan, 'overview_RevenueTTM': nan}, 2018: {'pe_mean_by_stock': nan, 'totalAssets': nan, 'totalLiabilities': nan, 'totalRevenue': nan, 'operatingCashflow': nan, 'netIncome': nan, 'overview_GrossProfitTTM': nan, 'overview_SharesFloat': nan, 'overview_SharesOutstanding': nan, 'lag_ma_10m': 33.956041666666664, 'lag_price_+6m': 37.321600000000004, 'lag_overview_52WeekHigh': nan, 'overview_52WeekHigh': nan, 'overview_200DayMovingAverage': nan, 'overview_50DayMovingAverage': nan, 'lag_overview_52WeekLow': nan, 'overview_52WeekLow': nan, 'overview_DilutedEPSTTM': nan, 'overview_PercentInstitutions': nan, 'overview_QuarterlyEarningsGrowthYOY': nan, 'overview_PercentInsiders': nan, 'overview_QuarterlyRevenueGrowthYOY': nan, 'lag_forward_6m_return': 0.0597681929339037, 'overview_Beta': nan, 'lag_price_vs_ma10': 1.0328408247205758, 'pe_trailing': nan, 'r1m_x_pe_trailing': 0.0, 'r1m_x_pe_mean_by_stock': 0.0, 'r3m_x_pe_trailing': 0.0, 'r3m_x_pe_mean_by_stock': 0.0, 'r6m_x_pe_trailing': 0.0, 'r6m_x_pe_mean_by_stock': 0.0, 'r12m_x_pe_trailing': 0.0, 'r12m_x_pe_mean_by_stock': 0.0, 'overview_MarketCapitalization': nan, 'overview_RevenueTTM': nan}}
Per-fold metrics:
{'train_years': [2019, 2020, 2021], 'test_year': 2022, 'r2': -0.4181051762106347, 'mae': 0.2913990513809043}
{'train_years': [2020, 2021, 2022], 'test_year': 2023, 'r2': -0.0031557041880245773, 'mae': 0.22634023513676502}
{'train_years': [2021, 2022, 2023], 'test_year': 2024, 'r2': 0.30334334164166776, 'mae': 0.17241880365087625}
{'train_years': [2022, 2023, 2024], 'test_year': 2025, 'r2': 0.44520821957218526, 'mae': 0.1595146876738996}
Stacker final R2: 0.0 MAE: 21586580779.886147
Saved: perm_importances_recomputed.json, stacked_model_imputed.pkl, stacked_metrics_imputed.json, cv_predictions_imputed.json
